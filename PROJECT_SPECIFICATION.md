# タスク自動整理システム (TM-OS) 仕様書

## 1. プロジェクト概要
LINE Messaging APIとNext.js、Supabase、Gemini AIを組み合わせたタスク管理システム。
ユーザーがLINEから入力したタスクをAIが自動解析し、優先度（S, A, B, C, DEV, IDEA）に応じて自動分類・整理する。

## 2. デザインコンセプト
- **Light & Pastel Aesthetics**: ダークモードから、清潔感のある白背景（#F8F9FA）と黒文字、目に優しいパステルカラーを基調としたモダンなデザインに刷新。
- **UI 構成**:
  - ヘッダー: タイトル（タスク自動整理 ver[デプロイ日]）、同期状況（Last Sync時間）、検索窓、AIタスク追加窓、ヘルプボタン、更新ボタン。
  - メイングリッド: 6カラム構成（S, A, B, C, DEV, IDEA）。各カラムは独自のパステル背景色を持つ。
  - 下部ドロップゾーン: モバイル向けの操作エリア（完了、保留、静観、削除）。清潔感のある白基調のタブ。
  - サイドドロワー: 完了済みなどのタスク一覧を表示。

## 3. 主要機能
### 3.1 タスク入力と同期
- **LINE連携**: メッセージ送信でAIがタスクを抽出。複数行送信で一括登録。
- **AIアドバイス**: コマンドが認識できない場合、具体的な登録・修正例を返信してユーザーをガイド。
- **AI解析**: Gemini APIを使用。タイトル、優先度、カテゴリーを自動判定。
- **同期状況**: ダッシュボードの最終更新時刻を表示し、データの鮮度を可視化。
- **ダッシュボード**: リアルタイム（focus時自動更新）でLINEからの入力を反映。
- **手動更新**: 更新ボタンにより即座に最新データを取得。

### 3.2 タスク操作
- **ドラッグ＆ドロップ**: `@dnd-kit` を使用。`pointerWithin` アルゴリズムにより、空のカラムや狭い画面でも確実な移動を実現。
- **直接編集**: タイトルをタップしてインライン編集。
- **検索・フィルタリング**: ヘッダーの検索窓からタスクを絞り込み。非該当タスクは透過表示される。

### 3.3 セキュリティと通知
- **アクセスログ**: 管理者画面（/dev）へのアクセスを監視し、DBに記録。
- **管理者通知**: 非管理者が機密エリアにアクセスした場合、またはシステムエラー発生時に管理者のLINEへ即座に通知を送信。

### 3.4 設定の永続化
- **ユーザー設定**: カラム名（DEV, IDEA）のカスタマイズ内容をSupabaseに保存。
- **マルチデバイス対応**: 異なるデバイスやブラウザでも設定が引き継がれる。

## 4. UI 演出
- **新規タスク強調**: 新しく追加されたタスクは5秒間、ソフトなグリーンのフラッシュアニメーションを表示。
- **カードデザイン**: タスクを独立した影付きカードとして表示。進行中のタスクにはアクセントラインを付与。

## 5. カラム定義 (Priority & Colors)
- **S**: 重要＋緊急（赤 / パステル：#FFF5F5）
- **A**: 緊急のみ（オレンジ / パステル：#FFF9F0）
- **B**: 重要のみ（青 / パステル：#F0F7FF）
- **C**: 低優先（緑 / パステル：#F1F9F1）
- **DEV**: 開発等・自由設定（紫 / パステル：#F9F4FC）※タイトル変更可能
- **IDEA**: 💡 アイデア（ピンク / パステル：#FFF4F9）※タイトル変更可能
